<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>会议管理</title>
  <link rel="stylesheet" href="../css/mettingManage.css">
  <link rel="stylesheet" href="../css/zTreeStyle.css">
</head>
<body>
  <div class="main">
    <!-- 搜索项 -->
    <div class="top_m">
      <div class="query_item">
        <span class="query_title">日期</span>：<span class="input_box"><input type="text"></span>
      </div>
      <div class="query_item">
        <span class="query_title">会议名称</span>：<span class="input_box"><input type="text"></span>
      </div>
      <div class="query_item">
        <span class="query_title">会议形式</span>：<span class="input_box"><input type="text"></span>
      </div>
      <div class="query_item">
        <span class="query_title">会议号</span>：<span class="input_box"><input type="text"></span>
      </div>
      <div class="query_item">
        <span class="query_title">会议时间</span>：<span class="input_box"><input type="text"></span>
      </div>
      <div class="query_item">
        <span class="query_title">会议地点</span>：<span class="input_box"><input type="text"></span>
      </div>
      <div class="query_item">
        <span class="query_title">会议日程</span>：<span class="input_box"><input type="text"></span>
      </div>
    </div>
    <hr>
    <div class="title_blue">会议材料:</div>
    <div class="file_box">
      <span class="file_list">
        <p id="fileList"></p>
      </span>
      <span class="btn file_btn">上传<input type="file" multiple="multiple" id="up_file"></span>
    </div>
    <div class="file_tips">注意：文件大小1M以内</div>
    <hr>
    <div class="title_blue">阅读对象(可多选)</div>
    <div class="border_box">
      <span class="color_blue">角色</span>
      <span class="check_box role">
        <input type="checkbox" id="allRole"><label for="allRole">所有</label>
        <input type="checkbox" id="role1"><label for="role1">内勤</label>
        <input type="checkbox" id="role2"><label for="role2">业务员</label>
      </span>
    </div>
    <div class="border_box">
      <span class="color_blue">机构级别</span>
      <span class="check_box">
        <input type="checkbox" id="all"><label for="all">发布人所在机构及其隶属所有分支机构</label>
      </span>
      <span class="color_blue margin_l" id="openMask">指定机构</span>
    </div>
    <div class="btn_box">
      <span class="btn big_btn">发布</span>
    </div>
    <div class="table_box">
      <table>
        <tr>
          <th>会议名称</th>
          <th>会议形式</th>
          <th>会议号</th>
          <th>会议时间</th>
          <th>会议地点</th>
          <th>会议日程</th>
          <th>会议材料</th>
          <th>备注</th>
        </tr>
        <tr>
          <td>内勤版上线宣导会</td>
          <td>视频会议</td>
          <td>88882333</td>
          <td>2018-11-22 16:00</td>
          <td>分公司会议室</td>
          <td>2018年11月22日</td>
          <td>无</td>
          <td>无</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </table>
    </div>
    <!-- 弹窗 -->
    <div class="mask"></div>
    <div class="mask_box">
      <div class="header">机构</div>
      <div class="content">
        <ul class="ztree" id="treeDom"></ul>
      </div>
      <div class="mask_btn">
        <span class="btn btn_primary">确定</span>
        <span class="btn btn_cancle">取消</span>
      </div>
    </div>  
  </div>
</body>
<script src="../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery.ztree.core.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery.ztree.excheck.js" type="text/javascript" charset="utf-8"></script>
<script>
  var zTreeObj;
  var setting = {
    check: {
      enable: true,
      chkStyle: "checkbox",
      nocheckInherit: true
    }
  };
  var zNodes = [
    {name:"公司", open:true, children:[
      {name:"总公司天津分公司1"}, {name:"天津分公司天津分公司1", children:[
        {name:"天津分公司1天津分公司1"},{name:"天津分公司1天津分公司2", children:[
          {name:"天津分公司10天津分公司1"},{name:"天津分公司1天津分公司20天津分公司1天津分公司1天津分公司1", children:[
            {name:"天津分公司10天津分公司1"},{name:"天津分公司1天津分公司20天津分公司1天津分公司1天津分公司1"}]
          }]
        }]
      },
      {name:"总公司天津分公司1"}
      ]
    },
    {name:"山西公司", open:true, children:[
      {name:"test2_1"}, {name:"test2_2"}, {name:"333222", children:[
        {name:"天津分公司1天津分公司1"},{name:"天津分公司1天津分公司2", children:[
          {name:"天津分公司10天津分公司1"},{name:"天津分公司1天津分公司20天津分公司1天津分公司1天津分公司1", children:[
            {name:"天津分公司10天津分公司1"},{name:"天津分公司1天津分公司20天津分公司1天津分公司1天津分公司1"}]
          }]
        }]
      }
    ]}
  ];

  $(function(){

    // 文件上传
    var count = 0;
    var fileSizeFlag = 0;
    var fileName;
    var fileNameSize;

    function addFile(){
      count++;

    }
    
    var inputBox = document.getElementById("up_file");
    inputBox.addEventListener("change",function(){
      var reader = new FileReader();
      // 获取input选取文件
      var uploadfile = $("#up_file").val(); 
      var fileNameArray = uploadfile.split('\\');

      var fileName= fileNameArray[fileNameArray.length-1];
      // console.log()
      var upfileList = [];  
      upfileList.push(fileName); 
      forFile(upfileList);  

      reader.readAsDataURL(inputBox.files[0]);//发起异步请求
      reader.onload = function(){
        //读取完成后，数据保存在对象的result属性中
        // 上传的图片列表   
        // console.log(this.result);
      }
    });
    
    function forFile(list){
      var dom = "";
      for(i in list){
        dom += '<span>'+ list[i] +'; </span>';
      }
      $("#fileList").append(dom);
    }

    $('#openMask').on('click',function(){
      $('.mask').show();
      $('.mask_box').show();

      zTreeObj = $.fn.zTree.init($("#treeDom"), setting, zNodes);
    });
    
    $('.btn_cancle').on('click',function(){
      $('.mask').hide();
      $('.mask_box').hide();
    })
    $('.mask').on('click',function(){
      $(this).hide();
      $('.mask_box').hide();
    })

  })
</script>
</html>